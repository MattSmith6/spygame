//Player awarded points for eliminatin other players

import android.annotation.SuppressLint
import android.content.Intent
import android.os.Bundle
import android.view.View
import android.widget.*
import androidx.appcompat.app.AlertDialog
import androidx.appcompat.app.AppCompatActivity
import java.util.*

class StartUp : AppCompatActivity() {
     var teamname: EditText? = null
     var playeridgenerate: TextView? = null
     var tvPoints: TextView? = null
     var addingdatateamplayer: Button? = null
    var viewdata: Button? = null
    var delet: Button? = null
    var DB: DBHelper? = null
    @SuppressLint("MissingInflatedId")
    public override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.startup)

        fun teamplayer(view: View?) {

            teamname = findViewById(R.id.player)
            playeridgenerate = findViewById<View>(R.id.generatenumber) as TextView
            addingdatateamplayer = findViewById(R.id.dataview)
            //this part obtains  input data from team player and generate id number auto
            //this part allows user to input data and play game when he presses the button


            val myRandom = Random()
            val buttonGenerate = findViewById<View>(R.id.generate) as Button
            val textGenerateNumber = findViewById<View>(R.id.generatenumber) as TextView
            buttonGenerate.setOnClickListener { // TODO Auto-generated method stub
                textGenerateNumber.text = myRandom.nextInt(1000).toString()
//this code line store data sqllite and transfer data other activity player manu box show player name and id
                addingdatateamplayer?.setOnClickListener(View.OnClickListener {
                    val username = teamname?.getText().toString()
                    val useridname = playeridgenerate!!.text.toString()
                    val intent = Intent(this@StartUp, GameOver::class.java)
                    intent.putExtra("keyplayername", username)
                    intent.putExtra("keyid", useridname)
                    startActivity(intent)
                })

        }
/// generate auto id number limit 1000 number id assign

        }

// this code path add all the data and show only throgh button
        teamname = findViewById(R.id.player)
        tvPoints = findViewById(R.id.kill)
        playeridgenerate = findViewById(R.id.generatenumber)
        add = findViewById(R.id.add)

        viewdata = findViewById(R.id.dataview)
        DB = DBHelper(this)
        add?.setOnClickListener(View.OnClickListener {
            val teamtxt = teamname?.getText().toString()
            val idtxt = playeridgenerate?.getText().toString()
            val killtxt = tvPoints?.getText().toString()
            val checkinsertdata = DB!!.insertuserdata(teamtxt, idtxt, killtxt)
        })

        viewdata?.setOnClickListener(View.OnClickListener {
            val res = DB!!.getdata()
            if (res.count == 0) {
                Toast.makeText(this@StartUp, "No Entry Exists", Toast.LENGTH_SHORT).show()
                return@OnClickListener
            }
            val buffer = StringBuffer()
            while (res.moveToNext()) {
                buffer.append(
                    """
    Player Name :${res.getString(0)}
    
    """.trimIndent()
                )
                buffer.append(
                    """
    Player Id :${res.getString(1)}
    
    """.trimIndent()
                )
                buffer.append(
                    """
    Player Kills:${res.getString(2)}
    
    
    """.trimIndent()
                )
            }
            val builder = AlertDialog.Builder(this@StartUp)
            builder.setCancelable(true)
            builder.setTitle("User Entries")
            builder.setMessage(buffer.toString())
            builder.show()
        })
    }

    fun startGame(view: View?) {
        startActivity(Intent(this, MainActivity::class.kotlin))
        finish()
    }


}
